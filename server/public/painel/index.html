<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Digital Signage — Painel</title>
  <link rel="stylesheet" href="/painel/styles.css" />
</head>
<body>
  <aside class="sidebar">
    <div class="brand">
      <img src="/assets/logo.jpg" onerror="this.onerror=null;this.src='/assets/default_logo.svg'" alt="Logo" class="logo-img"/>
      <div>
        <div class="brand-title">Digital Signage</div>
        <div class="brand-sub">Painel Profissional</div>
      </div>
    </div>
    <nav class="menu">
      <button data-tab="dashboard" class="active">Dashboard</button>
      <button data-tab="parear">Parear TV</button>
      <button data-tab="conteudo">Conteúdo & Playlist</button>
      <button data-tab="manager">Gerenciador de Playlists</button>
      <button data-tab="config">Configuração de Playlist</button>
      <button data-tab="tvs">TVs</button>
      <button data-tab="logs">Logs</button>
    </nav>
  </aside>
  <main class="content">
    <header class="topbar"><h1 id="page-title">Dashboard</h1></header>

    <section id="tab-dashboard" class="tab active">
      <div class="cards">
        <div class="kpi kpi-orange"><div>Total de TVs</div><b id="kpi-total">0</b></div>
        <div class="kpi"><div>Ativas</div><b id="kpi-ativas">0</b></div>
        <div class="kpi"><div>Offline</div><b id="kpi-off">0</b></div>
        <div class="kpi"><div>Pendentes</div><b id="kpi-pend">0</b></div>
      </div>
      <div class="panel">
        <h3>TVs Conectadas</h3>
        <div id="dash-tvs" class="tv-grid"></div>
      </div>
    </section>

    <section id="tab-parear" class="tab">
      <div class="panel form">
        <h3>Parear TV</h3>
        <div class="grid">
          <div><label>Pendências</label><select id="pair-select"></select></div>
          <div><label>Nome</label><input id="pair-name" placeholder="ex.: Recepção"/></div>
          <div><label>Local</label><input id="pair-location" placeholder="ex.: Matriz"/></div>
          <div><label>Grupo</label><input id="pair-group" placeholder="ex.: Andar 3"/></div>
        </div>
        <button id="btn-approve" class="primary">Aprovar</button>
        <p id="pair-result" class="result"></p>
        <div id="pair-pending" class="panel minimal"></div>
      </div>
    </section>

    <section id="tab-conteudo" class="tab">
      <div class="panel">
        <h3 id="pl-name-title" class="brand-title" style="margin:0 0 8px 0"></h3>
        <div class="toolbar">
          <div>
            <label>Selecionar TV</label>
            <select id="pl-tv"></select>
          </div>
          <div class="actions">
            <div class="hint">Ações aplicadas à <b>playlist da TV selecionada</b>.</div>
            <div style="min-width:220px"><label>Nome da Playlist</label><input id="pl-name" placeholder="ex.: Promoções Novembro"/></div>
            <div class="multi-tv">
              <label>Selecionar TVs (múltiplo)</label>
              <select id="pl-tv-multi" multiple style="min-width:220px"></select>
              <div id="pl-tv-chips" class="chips" aria-label="TVs selecionadas"></div>
              <button id="btn-assign-tvs" title="Atribuir playlist a TVs selecionadas">Atribuir a TVs</button>
            </div>
            <button id="btn-save" class="primary" title="Salvar e enviar a playlist da TV selecionada">Salvar / Enviar</button>
          </div>
        </div>
        <div class="layout">
          <div class="col">
            <h4>Mídia</h4>
            <div class="actions" style="margin-bottom:8px">
              <input type="file" id="file-input" accept="image/*,video/*" multiple title="Enviar arquivos para o banco de mídias" />
              <button id="btn-upload" class="primary" title="Enviar arquivos selecionados">Upload</button>
            </div>
            <div id="media-grid" class="grid-thumbs minimal"></div>
          </div>
          <div class="col">
            <h4>Playlist: <span id="pl-title" class="brand-sub"></span></h4>
            <div id="pl-items" class="pl-list"></div>
            <p class="hint">Arraste para ordenar | Clique para editar duração.</p>
            <div class="fixed">
              <h4>Agendamento Global da Playlist</h4>
              <div class="fixed-row">
                <input id="pl-global-start" type="datetime-local" placeholder="Início"/>
                <input id="pl-global-end" type="datetime-local" placeholder="Fim"/>
                <button id="btn-apply-global">Aplicar a todos os itens</button>
              </div>
              <p class="hint">Aplicará o intervalo a todos os itens desta playlist.</p>
            </div>
            <div class="fixed">
              <h4>Conteúdo Fixo</h4>
              <label><input type="checkbox" id="fixed-enabled"/> Ativar (um arquivo o dia todo)</label>
              <div class="fixed-row">
                <input id="fixed-src" placeholder="/uploads/arquivo.jpg ou .mp4"/>
                <select id="fixed-type"><option value="image">Imagem</option><option value="video">Vídeo</option></select>
                <button id="btn-use-selected">Usar seleção</button>
              </div>
            </div>
          </div>
          <div class="col">
            <h4>Pré-visualização</h4>
            <div class="preview-area">
              <img id="preview-img" style="display:none;"/>
              <video id="preview-video" style="display:none;" controls muted></video>
              <div class="actions" style="position:absolute;bottom:10px;right:10px;display:flex;gap:8px">
                <button id="prev-clear" title="Limpar pré-visualização">Limpar</button>
                <a id="prev-open" class="button-link" href="#" target="_blank" title="Abrir em nova aba">Abrir</a>
              </div>
            </div>
            <p class="hint" id="prev-status"></p>
          </div>
        </div>
        <p id="pl-status" class="result"></p>
      </div>
    </section>

    <section id="tab-tvs" class="tab">
      <div class="panel">
        <h3>TVs</h3>
        <table id="tvs-table"><thead><tr><th>Nome</th><th>Local</th><th>Uptime</th><th>Agora</th><th>Preview</th><th>Ações</th></tr></thead><tbody></tbody></table>
      </div>
    </section>

    <section id="tab-logs" class="tab">
      <div class="panel">
        <h3>Logs</h3>
        <pre id="logs-box" class="logs"></pre>
        <button id="btn-refresh-logs">Atualizar</button>
      </div>
    </section>

    <section id="tab-config" class="tab">
      <div class="panel">
        <h3>Configuração de Playlist</h3>
        <div class="grid">
          <div><label>Selecionar TV</label><select id="cfg-tv"></select></div>
          <div><label>Item da playlist</label><select id="cfg-item"></select></div>
        </div>
        <div class="calendar" id="cfg-calendar">
          <div class="cal-header">
            <button id="cal-prev" aria-label="Mês anterior" title="Mês anterior"><svg viewBox="0 0 24 24" aria-hidden="true"><path d="M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12z"/></svg></button>
            <div id="cal-title"></div>
            <button id="cal-next" aria-label="Próximo mês" title="Próximo mês"><svg viewBox="0 0 24 24" aria-hidden="true"><path d="M8.59 16.59 13.17 12 8.59 7.41 10 6l6 6-6 6z"/></svg></button>
          </div>
          <div class="cal-grid" id="cal-grid"></div>
          <div class="time-select">
            <div><label>Início</label><select id="time-start" title="Selecione o horário de início (intervalos de 15 min)"></select></div>
            <div><label>Fim</label><select id="time-end" title="Selecione o horário de término (intervalos de 15 min)"></select></div>
          </div>
          <p class="hint" id="cfg-summary"></p>
          <div class="actions"><button id="cfg-apply" class="primary" title="Aplicar intervalo selecionado ao item da playlist">Aplicar à playlist</button></div>
        </div>
      </div>
    </section>

    <section id="tab-manager" class="tab">
      <div class="panel">
        <h3>Gerenciador de Playlists</h3>
        <div class="grid">
          <div style="grid-column:1/3">
            <div class="toolbar">
              <input id="mgr-search" placeholder="Buscar playlists"/>
              <div class="actions"><input id="mgr-new-name" placeholder="Nome da playlist"/><button id="mgr-create" class="primary">[+] Criar Nova</button></div>
            </div>
            <div id="mgr-list" class="mgr-list"></div>
          </div>
          <div>
            <div class="toolbar">
              <div class="status" id="mgr-status"></div>
              <div class="actions"><button id="mgr-assign" class="primary">Atribuir a TVs</button></div>
            </div>
            <div id="mgr-timeline" class="timeline"></div>
            <h4>Biblioteca de Mídias</h4>
            <div id="mgr-media" class="grid-thumbs minimal"></div>
            <div class="preview-area">
              <img id="mgr-prev-img" style="display:none;"/>
              <video id="mgr-prev-video" style="display:none;" controls muted></video>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <script type="module" src="/painel/js/nav.js"></script>
  <script type="module" src="/painel/js/pairing.js"></script>
  <script type="module" src="/painel/js/dashboard.js"></script>
  <script type="module" src="/painel/js/playlist.js"></script>
  <script type="module" src="/painel/js/schedule.js"></script>
  <script type="module" src="/painel/js/manager.js"></script>
  <script type="module" src="/painel/js/uploads.js"></script>
  <script type="module" src="/painel/js/tvs.js"></script>
  <script type="module" src="/painel/js/logs.js"></script>
</body>
</html>
